<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Inventario</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- LOGIN PAGE -->
    <div class="login-container" id="loginPage">
        <h1>üè™ Sistema de Inventario</h1>
        <p>Ingresa tus credenciales para continuar</p>
        
        <form id="loginForm">
            <div class="input-group">
                <label>Email</label>
                <input type="email" id="username" placeholder="Ingresa tu email" required>
            </div>
            
            <div class="input-group">
                <label>Contrase√±a</label>
                <input type="password" id="password" placeholder="Ingresa tu contrase√±a" required>
            </div>
            
            <button type="submit" class="btn-login">Iniciar Sesi√≥n</button>
        </form>
        
        <p style="margin-top: 20px; font-size: 12px;" class="text-light;">
            Usuario demo:<br>
            <strong>admin@inventario.com</strong><br>
            Contrase√±a: <strong>admin123</strong>
        </p>
    </div>

    <!-- DASHBOARD -->
    <div class="dashboard" id="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>üì¶ Inventario</h2>
                <button class="dark-mode-toggle" id="darkModeToggle" title="Cambiar tema">üåô</button>
            </div>
            
            <div class="sidebar-menu">
                <div class="menu-item active" data-section="dashboard">
                    <span>üìä</span> Dashboard
                </div>
                <div class="menu-item" data-section="productos">
                    <span>üì¶</span> Productos
                </div>
                <div class="menu-item" data-section="categorias">
                    <span>üè∑Ô∏è</span> Categor√≠as
                </div>
                <div class="menu-item" data-section="movimientos">
                    <span>üìã</span> Movimientos
                </div>
                <div class="menu-item" data-section="asignaciones">
                    <span>üë•</span> Asignaciones
                </div>
                <div class="menu-item" data-section="proveedores">
                    <span>üè≠</span> Proveedores
                </div>
                <div class="menu-item" data-section="usuarios" id="menuUsuarios" style="display:none;">
                    <span>üë§</span> Usuarios
                </div>
                <div class="menu-item" data-section="busqueda">
                    <span>üîç</span> B√∫squeda
                </div>
                <div class="menu-item" data-section="reportes">
                    <span>üìà</span> Reportes
                </div>
            </div>
            
            <button class="logout-btn" onclick="logout()">üö™ Cerrar Sesi√≥n</button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="top-bar">
                <h1 id="pageTitle">Dashboard</h1>
                <div class="user-info">
                    <div class="user-avatar">A</div>
                    <div>
                        <div style="font-weight: 600; color: var(--text-dark);">Admin</div>
                        <div style="font-size: 12px;" class="text-gray">Administrador</div>
                    </div>
                </div>
            </div>

            <!-- DASHBOARD SECTION -->
            <div class="content-section active" id="section-dashboard">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>TOTAL PRODUCTOS</h3>
                        <div class="stat-value" id="totalProductos">0</div>
                        <div class="stat-change">‚Üë Activos</div>
                    </div>
                    <div class="stat-card">
                        <h3>STOCK TOTAL</h3>
                        <div class="stat-value" id="stockTotal">0</div>
                        <div class="stat-change">unidades</div>
                    </div>
                    <div class="stat-card">
                        <h3>STOCK BAJO</h3>
                        <div class="stat-value" id="stockBajo">0</div>
                        <div class="stat-change" style="color: #ef4444;">‚ö†Ô∏è Productos</div>
                    </div>
                    <div class="stat-card">
                        <h3>CATEGOR√çAS</h3>
                        <div class="stat-value" id="totalCategorias">0</div>
                        <div class="stat-change">activas</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>Productos con Stock Bajo</h2>
                    </div>
                    <table id="stockBajoTable">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>SKU</th>
                                <th>Stock Actual</th>
                                <th>Stock M√≠nimo</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- PRODUCTOS SECTION -->
            <div class="content-section" id="section-productos">
                <div class="card">
                    <div class="card-header">
                        <h2>Gesti√≥n de Productos</h2>
                        <div class="flex-gap">
                            <input type="text" class="search-box" id="searchProductos" placeholder="üîç Buscar productos...">
                            <button class="btn btn-primary" onclick="mostrarFormProducto()">+ Nuevo Producto</button>
                        </div>
                    </div>

                    <div id="formProducto" class="hidden form-section">
                        <h3 class="form-title">Agregar Producto</h3>
                        <form id="productoForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Nombre</label>
                                    <input type="text" name="nombre" required>
                                </div>
                                <div class="form-group">
                                    <label>SKU</label>
                                    <input type="text" name="sku" required>
                                </div>
                                <div class="form-group">
                                    <label>Precio</label>
                                    <input type="number" step="0.01" name="precio" required>
                                </div>
                                <div class="form-group">
                                    <label>Stock Inicial</label>
                                    <input type="number" name="stock" value="0">
                                </div>
                                <div class="form-group">
                                    <label>Stock M√≠nimo</label>
                                    <input type="number" name="stock_minimo" value="0">
                                </div>
                                <div class="form-group">
                                    <label>Categor√≠a</label>
                                    <select name="categoria_id" id="categoriaSelect"></select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Descripci√≥n</label>
                                <textarea name="descripcion" rows="3"></textarea>
                            </div>
                            <div class="form-group-row">
                                <button type="submit" class="btn btn-success">Guardar</button>
                                <button type="button" class="btn btn-cancel" onclick="ocultarFormProducto()">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <table id="productosTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>SKU</th>
                                <th>Categor√≠a</th>
                                <th>Precio</th>
                                <th>Stock</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- CATEGOR√çAS SECTION -->
            <div class="content-section" id="section-categorias">
                <div class="card">
                    <div class="card-header">
                        <h2>Gesti√≥n de Categor√≠as</h2>
                        <button class="btn btn-primary" onclick="mostrarFormCategoria()">+ Nueva Categor√≠a</button>
                    </div>

                    <div id="formCategoria" class="hidden form-section">
                        <h3 class="form-title">Agregar Categor√≠a</h3>
                        <form id="categoriaForm">
                            <div class="form-group">
                                <label>Nombre</label>
                                <input type="text" name="nombre" required>
                            </div>
                            <div class="form-group">
                                <label>Descripci√≥n</label>
                                <textarea name="descripcion" rows="3"></textarea>
                            </div>
                            <div class="form-group-row">
                                <button type="submit" class="btn btn-success">Guardar</button>
                                <button type="button" class="btn btn-cancel" onclick="ocultarFormCategoria()">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <table id="categoriasTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Descripci√≥n</th>
                                <th>Fecha Creaci√≥n</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- MOVIMIENTOS SECTION -->
            <div class="content-section" id="section-movimientos">
                <div class="card">
                    <div class="card-header">
                        <h2>Registrar Movimiento</h2>
                    </div>
                    <form id="movimientoForm" class="form-section">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Producto</label>
                                <select name="producto_id" id="productoSelectMov" required></select>
                            </div>
                            <div class="form-group">
                                <label>Tipo de Movimiento</label>
                                <select name="tipo" required>
                                    <option value="ENTRADA">Entrada (Agregar Stock)</option>
                                    <option value="SALIDA">Salida (Retirar Stock)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Cantidad</label>
                                <input type="number" name="cantidad" min="1" required>
                            </div>
                            <div class="form-group">
                                <label>Motivo</label>
                                <input type="text" name="motivo" placeholder="Ej: Compra, Venta, Devoluci√≥n">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Registrar Movimiento</button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>√öltimos Movimientos</h2>
                    </div>
                    <table id="movimientosTable">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Producto</th>
                                <th>Tipo</th>
                                <th>Cantidad</th>
                                <th>Motivo</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- ASIGNACIONES SECTION -->
            <div class="content-section" id="section-asignaciones">
                <div class="card">
                    <div class="card-header">
                        <h2>Nueva Asignaci√≥n</h2>
                    </div>
                    <form id="asignacionForm" class="form-section">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Producto</label>
                                <select name="producto_id" id="productoSelectAsig" required></select>
                            </div>
                            <div class="form-group">
                                <label>Asignar a</label>
                                <select name="destino_tipo" id="destinoTipo" required onchange="cambiarDestinoTipo()">
                                    <option value="">Seleccionar...</option>
                                    <option value="personal">Personal</option>
                                    <option value="tienda">Tienda/Destino</option>
                                </select>
                            </div>
                            <div class="form-group" id="grupoPersonal" style="display:none;">
                                <label>Personal</label>
                                <select name="personal_id" id="personalSelect"></select>
                            </div>
                            <div class="form-group" id="grupoDestino" style="display:none;">
                                <label>Destino</label>
                                <select name="destino_id" id="destinoSelect"></select>
                            </div>
                            <div class="form-group">
                                <label>Cantidad</label>
                                <input type="number" name="cantidad" min="1" required>
                            </div>
                            <div class="form-group">
                                <label>Observaciones</label>
                                <textarea name="observaciones" rows="2"></textarea>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Registrar Asignaci√≥n</button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>Historial de Asignaciones</h2>
                        <div class="flex-gap">
                            <select id="filtroAsignaciones" onchange="cargarAsignaciones()">
                                <option value="todas">Todas</option>
                                <option value="asignado">Asignadas</option>
                                <option value="devuelto">Devueltas</option>
                            </select>
                        </div>
                    </div>
                    <table id="asignacionesTable">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Producto</th>
                                <th>Asignado a</th>
                                <th>Cantidad</th>
                                <th>Estado</th>
                                <th>Usuario</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <!-- Gesti√≥n de Personal -->
                <div class="card">
                    <div class="card-header">
                        <h2>Gesti√≥n de Personal</h2>
                        <button class="btn btn-primary" onclick="mostrarFormPersonal()">+ Agregar Personal</button>
                    </div>

                    <div id="formPersonal" class="hidden form-section">
                        <h3 class="form-title">Nuevo Personal</h3>
                        <form id="personalForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Nombre</label>
                                    <input type="text" name="nombre" required>
                                </div>
                                <div class="form-group">
                                    <label>Puesto</label>
                                    <input type="text" name="puesto">
                                </div>
                                <div class="form-group">
                                    <label>Departamento</label>
                                    <select name="departamento_id" id="departamentoSelect"></select>
                                </div>
                                <div class="form-group">
                                    <label>Zona</label>
                                    <select name="zona_id" id="zonaSelect"></select>
                                </div>
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" name="email">
                                </div>
                                <div class="form-group">
                                    <label>Tel√©fono</label>
                                    <input type="tel" name="telefono">
                                </div>
                            </div>
                            <div class="form-group-row">
                                <button type="submit" class="btn btn-success">Guardar</button>
                                <button type="button" class="btn btn-cancel" onclick="ocultarFormPersonal()">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <table id="personalTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Puesto</th>
                                <th>Departamento</th>
                                <th>Zona</th>
                                <th>Asignaciones</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- PROVEEDORES SECTION -->
            <div class="content-section" id="section-proveedores">
                <div class="card">
                    <div class="card-header">
                        <h2>Gesti√≥n de Proveedores</h2>
                        <button class="btn btn-primary" onclick="mostrarFormProveedor()">+ Nuevo Proveedor</button>
                    </div>

                    <div id="formProveedor" class="hidden form-section">
                        <h3 class="form-title">Agregar Proveedor</h3>
                        <form id="proveedorForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Nombre</label>
                                    <input type="text" name="nombre" required>
                                </div>
                                <div class="form-group">
                                    <label>Contacto</label>
                                    <input type="text" name="contacto">
                                </div>
                                <div class="form-group">
                                    <label>Tel√©fono</label>
                                    <input type="tel" name="telefono">
                                </div>
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" name="email">
                                </div>
                                <div class="form-group">
                                    <label>Sitio Web</label>
                                    <input type="url" name="sitio_web" placeholder="https://...">
                                </div>
                                <div class="form-group">
                                    <label>Direcci√≥n</label>
                                    <input type="text" name="direccion">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Notas</label>
                                <textarea name="notas" rows="3"></textarea>
                            </div>
                            <div class="form-group-row">
                                <button type="submit" class="btn btn-success">Guardar</button>
                                <button type="button" class="btn btn-cancel" onclick="ocultarFormProveedor()">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <table id="proveedoresTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Contacto</th>
                                <th>Tel√©fono</th>
                                <th>Email</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- USUARIOS SECTION (Solo visible para Admin) -->
            <div class="content-section" id="section-usuarios">
                <div class="card">
                    <div class="card-header">
                        <h2>Gesti√≥n de Usuarios</h2>
                        <button class="btn btn-primary" onclick="mostrarFormUsuario()">+ Nuevo Usuario</button>
                    </div>

                    <div id="formUsuario" class="hidden form-section">
                        <h3 class="form-title">Agregar Usuario</h3>
                        <form id="usuarioForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Nombre Completo</label>
                                    <input type="text" name="nombre" required>
                                </div>
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" name="email" required>
                                </div>
                                <div class="form-group">
                                    <label>Contrase√±a</label>
                                    <input type="password" name="password" required minlength="6">
                                </div>
                                <div class="form-group">
                                    <label>Rol</label>
                                    <select name="rol_id" required>
                                        <option value="1">Administrador</option>
                                        <option value="2" selected>Usuario</option>
                                        <option value="3">Visitante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group-row">
                                <button type="submit" class="btn btn-success">Crear Usuario</button>
                                <button type="button" class="btn btn-cancel" onclick="ocultarFormUsuario()">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <table id="usuariosTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Rol</th>
                                <th>Estado</th>
                                <th>√öltimo Acceso</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- B√öSQUEDA AVANZADA SECTION (SEPARADA) -->
            <div class="content-section" id="section-busqueda">
                <div class="card">
                    <div class="card-header">
                        <h2>üîç B√∫squeda Avanzada de Productos</h2>
                    </div>
                    <form id="busquedaAvanzadaForm" class="form-section">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>T√©rmino de b√∫squeda</label>
                                <input type="text" name="termino" placeholder="Nombre, SKU o descripci√≥n...">
                            </div>
                            <div class="form-group">
                                <label>Categor√≠a</label>
                                <select name="categoria_id" id="busquedaCategoriaSelect">
                                    <option value="">Todas</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Proveedor</label>
                                <select name="proveedor_id" id="busquedaProveedorSelect">
                                    <option value="">Todos</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Stock m√≠nimo</label>
                                <input type="number" name="stock_minimo" min="0" placeholder="Desde...">
                            </div>
                            <div class="form-group">
                                <label>Stock m√°ximo</label>
                                <input type="number" name="stock_maximo" min="0" placeholder="Hasta...">
                            </div>
                            <div class="form-group">
                                <label>Precio m√≠nimo</label>
                                <input type="number" name="precio_min" step="0.01" placeholder="Desde...">
                            </div>
                            <div class="form-group">
                                <label>Precio m√°ximo</label>
                                <input type="number" name="precio_max" step="0.01" placeholder="Hasta...">
                            </div>
                        </div>
                        <div class="form-group-row">
                            <button type="submit" class="btn btn-primary">üîç Buscar</button>
                            <button type="button" class="btn btn-cancel" onclick="limpiarBusqueda()">Limpiar</button>
                        </div>
                    </form>
                    
                    <div id="resultadosBusqueda" class="hidden" style="margin-top: 20px;">
                        <h3 class="form-title">Resultados: <span id="cantidadResultados">0</span> productos</h3>
                        <table id="resultadosBusquedaTable">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>SKU</th>
                                    <th>Categor√≠a</th>
                                    <th>Proveedor</th>
                                    <th>Stock</th>
                                    <th>Precio</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- REPORTES SECTION (SEPARADA) -->
            <div class="content-section" id="section-reportes">
                <!-- Reportes R√°pidos -->
                <div class="card">
                    <div class="card-header">
                        <h2>‚ö° Reportes R√°pidos</h2>
                    </div>
                    <div class="grid-2col">
                        <div class="report-card">
                            <h3 style="margin-bottom: 10px;">üìä Inventario Completo</h3>
                            <p class="text-gray" style="margin-bottom: 15px;">Descarga el listado completo actual</p>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-primary" onclick="descargarInventarioCompleto()">üì• Excel</button>
                                <button class="btn btn-success" onclick="descargarInventarioPDF()">üìÑ PDF</button>
                            </div>
                        </div>
                        <div class="report-card">
                            <h3 style="margin-bottom: 10px;">‚ö†Ô∏è Stock Bajo</h3>
                            <p class="text-gray" style="margin-bottom: 15px;">Productos con stock cr√≠tico</p>
                            <button class="btn btn-primary" onclick="descargarStockBajo()">üì• Descargar PDF</button>
                        </div>
                        <div class="report-card">
                            <h3 style="margin-bottom: 10px;">üì§ Exportar Productos</h3>
                            <p class="text-gray" style="margin-bottom: 15px;">Exportar todos los productos a CSV</p>
                            <button class="btn btn-success" onclick="exportarProductosCSV()">üì§ Exportar CSV</button>
                        </div>
                        <div class="report-card">
                            <h3 style="margin-bottom: 10px;">üì• Importar Productos</h3>
                            <p class="text-gray" style="margin-bottom: 15px;">Importar desde archivo CSV</p>
                            <button class="btn btn-success" onclick="abrirImportarCSV()">üì• Importar CSV</button>
                        </div>
                    </div>
                </div>

                <!-- Reporte de Movimientos con Filtros -->
                <div class="card">
                    <div class="card-header">
                        <h2>üìã Reporte de Movimientos</h2>
                    </div>
                    <form id="reporteMovimientosForm" class="form-section">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Fecha inicio</label>
                                <input type="date" name="fecha_inicio" id="fechaInicio" required>
                            </div>
                            <div class="form-group">
                                <label>Fecha fin</label>
                                <input type="date" name="fecha_fin" id="fechaFin" required>
                            </div>
                            <div class="form-group">
                                <label>Tipo de movimiento</label>
                                <select name="tipo" id="tipoMovimiento">
                                    <option value="TODOS">Todos</option>
                                    <option value="ENTRADA">Entradas</option>
                                    <option value="SALIDA">Salidas</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Categor√≠a</label>
                                <select name="categoria_id" id="reporteCategoriaSelect">
                                    <option value="">Todas</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group-row">
                            <button type="submit" class="btn btn-primary">Ver Reporte</button>
                            <button type="button" class="btn btn-success" onclick="descargarPDFMovimientos()">üìÑ Descargar PDF</button>
                        </div>
                    </form>
                    
                    <div id="resultadosReporte" class="hidden" style="margin-top: 20px;">
                        <div class="stats-grid" style="margin-bottom: 20px;">
                            <div class="stat-card">
                                <h3>Total Movimientos</h3>
                                <div class="stat-value" id="reporteTotalMovimientos">0</div>
                            </div>
                            <div class="stat-card">
                                <h3>Cantidad Total</h3>
                                <div class="stat-value" id="reporteCantidadTotal">0</div>
                            </div>
                            <div class="stat-card">
                                <h3>Valor Total</h3>
                                <div class="stat-value" id="reporteValorTotal">L.0.00</div>
                            </div>
                        </div>
                        
                        <table id="reporteMovimientosTable">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Producto</th>
                                    <th>Tipo</th>
                                    <th>Cantidad</th>
                                    <th>Precio Unit.</th>
                                    <th>Subtotal</th>
                                    <th>Usuario</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Reporte de Gastos -->
                <div class="card">
                    <div class="card-header">
                        <h2>üí∞ Reporte de Gastos</h2>
                    </div>
                    <form id="reporteGastosForm" onsubmit="event.preventDefault(); generarReporteGastos();" class="form-section">
                        <div class="form-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                            <div class="form-group">
                                <label>Fecha inicio</label>
                                <input type="date" id="gastosInicio" required>
                            </div>
                            <div class="form-group">
                                <label>Fecha fin</label>
                                <input type="date" id="gastosFin" required>
                            </div>
                            <div class="form-group" style="display: flex; align-items: flex-end;">
                                <button type="submit" class="btn btn-primary" style="width: 100%;">Generar</button>
                            </div>
                        </div>
                    </form>
                    
                    <div id="resultadosGastos" class="hidden" style="margin-top: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 class="form-title" style="margin: 0;">Resumen de Gastos</h3>
                            <button class="btn btn-success" onclick="descargarPDFGastos()">üìÑ Descargar PDF</button>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Total de Salidas</h3>
                                <div class="stat-value" id="gastosMovimientos">0</div>
                            </div>
                            <div class="stat-card">
                                <h3>Unidades Totales</h3>
                                <div class="stat-value" id="gastosUnidades">0</div>
                            </div>
                            <div class="stat-card">
                                <h3>Gasto Total</h3>
                                <div class="stat-value" id="gastosTotal">L.0.00</div>
                            </div>
                        </div>
                        
                        <h4 class="form-title">Gastos por Categor√≠a</h4>
                        <table id="gastosCategoriaTable">
                            <thead>
                                <tr>
                                    <th>Categor√≠a</th>
                                    <th>Cantidad</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        
                        <h4 class="form-title" style="margin-top: 20px;">Detalle de Movimientos</h4>
                        <table id="gastosDetalleTable">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Producto</th>
                                    <th>Cantidad</th>
                                    <th>Precio</th>
                                    <th>Subtotal</th>
                                    <th>Usuario</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- Modal para editar producto -->
    <div class="modal-overlay" id="modalEditarProducto">
        <div class="modal">
            <div class="modal-header">
                <h2>Editar Producto</h2>
                <button class="modal-close" onclick="cerrarModalEditarProducto()">√ó</button>
            </div>
            <form id="formEditarProducto">
                <input type="hidden" id="editProductoId">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nombre</label>
                        <input type="text" id="editNombre" required>
                    </div>
                    <div class="form-group">
                        <label>SKU</label>
                        <input type="text" id="editSku" required disabled>
                    </div>
                    <div class="form-group">
                        <label>Precio</label>
                        <input type="number" step="0.01" id="editPrecio" required>
                    </div>
                    <div class="form-group">
                        <label>Stock M√≠nimo</label>
                        <input type="number" id="editStockMinimo">
                    </div>
                    <div class="form-group">
                        <label>Categor√≠a</label>
                        <select id="editCategoria"></select>
                    </div>
                    <div class="form-group">
                        <label>Estado</label>
                        <select id="editActivo">
                            <option value="true">Activo</option>
                            <option value="false">Inactivo</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Descripci√≥n</label>
                    <textarea id="editDescripcion" rows="3"></textarea>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">Guardar Cambios</button>
                    <button type="button" class="btn" onclick="cerrarModalEditarProducto()" style="background: #e5e7eb;">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL REPORTE MOVIMIENTOS -->
    <div id="modalReporteMovimientos" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 400px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <h2 style="margin-bottom: 20px; text-align: center;">Selecciona Tipo de Reporte</h2>
            
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button class="btn btn-success" style="padding: 12px; font-size: 14px; border: none; cursor: pointer;" onclick="generarReportePDF('ENTRADA')">
                    üì• Reporte de Ingresos (Entrada)
                </button>
                <button class="btn btn-warning" style="padding: 12px; font-size: 14px; border: none; cursor: pointer; background: #f59e0b; color: white;" onclick="generarReportePDF('SALIDA')">
                    üì§ Reporte de Salidas
                </button>
            </div>
            
            <button class="btn" style="width: 100%; margin-top: 15px; padding: 10px; background: #e5e7eb; border: none; cursor: pointer; border-radius: 5px;" onclick="cerrarModalReporteMovimientos()">
                Cancelar
            </button>
        </div>
    </div>

    <!-- Modal para gestionar im√°genes de producto -->
    <div class="modal-overlay" id="modalImagenes">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h2>üñºÔ∏è Gesti√≥n de Im√°genes</h2>
                <button class="modal-close" onclick="cerrarModalImagenes()">√ó</button>
            </div>
            
            <div>
                <h3 class="form-title">Producto: <span id="imagenProductoNombre"></span></h3>
                
                <!-- Subir nuevas im√°genes -->
                <div class="form-section">
                    <h4 style="margin-bottom: 10px;">Subir Im√°genes</h4>
                    <form id="subirImagenesForm">
                        <input type="hidden" id="imagenProductoId">
                        <div class="form-group">
                            <label>Seleccionar im√°genes (m√°x. 5, 5MB c/u)</label>
                            <input type="file" name="imagenes" id="inputImagenes" multiple accept="image/*" required>
                        </div>
                        <button type="submit" class="btn btn-success">Subir Im√°genes</button>
                    </form>
                </div>
                
                <!-- Galer√≠a de im√°genes -->
                <div style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">Im√°genes Actuales</h4>
                    <div id="galeriaImagenes" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px;">
                        <p class="text-gray">Cargando im√°genes...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para generar QR -->
    <div class="modal-overlay" id="modalQR">
        <div class="modal">
            <div class="modal-header">
                <h2>üì± Generar C√≥digo QR</h2>
                <button class="modal-close" onclick="cerrarModalQR()">√ó</button>
            </div>
            
            <div style="text-align: center;">
                <h3 class="form-title" id="qrProductoNombre"></h3>
                <p class="text-gray" style="margin-bottom: 20px;">SKU: <span id="qrProductoSKU"></span></p>
                
                <div style="background: white; padding: 20px; border-radius: 10px; display: inline-block; margin-bottom: 20px;">
                    <canvas id="qrCanvas"></canvas>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="descargarQR()">üì• Descargar QR</button>
                    <button class="btn btn-success" onclick="imprimirEtiqueta()">üñ®Ô∏è Imprimir Etiqueta</button>
                </div>
                
                <div class="form-section" style="margin-top: 20px; text-align: left;">
                    <h4 style="margin-bottom: 10px;">Informaci√≥n de la Etiqueta</h4>
                    <p style="font-size: 12px;" class="text-gray">
                        ‚Ä¢ Formato: 2" x 1" (50mm x 25mm)<br>
                        ‚Ä¢ Compatible con: Zebra, Brother, Dymo<br>
                        ‚Ä¢ Incluye: QR, SKU, Nombre, Fecha<br>
                        ‚Ä¢ Descarga como imagen PNG
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notificaciones de Stock Bajo (bottom-right) -->
    <div id="notificacionesStockBajo" style="position: fixed; bottom: 80px; right: 20px; z-index: 999; max-width: 350px; display: none;">
        <div style="background: white; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); padding: 15px; border-left: 4px solid #f59e0b;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                <h4 style="color: #f59e0b; margin: 0; font-size: 14px;">‚ö†Ô∏è Alertas de Stock Bajo</h4>
                <button onclick="cerrarNotificacionesStock()" style="background: none; border: none; cursor: pointer; font-size: 18px; color: #999;">√ó</button>
            </div>
            <div id="listaNotificacionesStock" style="max-height: 200px; overflow-y: auto; font-size: 12px;">
                <!-- Se llena din√°micamente -->
            </div>
            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e5e7eb;">
                <label style="display: flex; align-items: center; gap: 8px; font-size: 12px; cursor: pointer;">
                    <input type="checkbox" id="desactivarNotificaciones" onchange="toggleNotificaciones()">
                    <span class="text-gray">No mostrar m√°s</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Librer√≠a para QR Codes -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>